<nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
  <div class="max-w-full px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <!-- Left Section - Logo and App Name -->
      <div class="flex items-center space-x-4">
        <div class="flex items-center space-x-3">
          <div
            class="flex items-center justify-center w-8 h-8 bg-blue-600 rounded-lg"
          >
            <ion-icon
              name="business-outline"
              class="text-white text-lg"
            ></ion-icon>
          </div>
          <div class="hidden sm:block">
            <h1 class="text-xl font-bold text-gray-900">Corporate Banking</h1>
          </div>
        </div>

        <!-- Role Badge -->
        <div class="hidden md:block">
          <span
            class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium"
            [ngClass]="getRoleBadgeClass(currentUser?.role)"
          >
            <ion-icon
              [name]="getRoleIcon(currentUser?.role)"
              class="text-xs mr-1"
            ></ion-icon>
            {{ currentUser?.role }}
          </span>
        </div>
      </div>

      <!-- Right Section - User Info and Actions -->
      <div class="flex items-center space-x-4">
        <!-- Notifications (Optional) -->
        <!-- <button
          class="hidden sm:flex items-center justify-center w-10 h-10 rounded-full hover:bg-gray-100 transition-colors relative"
        >
          <ion-icon
            name="notifications-outline"
            class="text-gray-600 text-lg"
          ></ion-icon>

          <span
            class="absolute -top-1 -right-1 h-3 w-3 bg-red-500 rounded-full"
          ></span>
        </button> -->

        <!-- User Profile Section -->
        <div class="relative" #userMenuRef>
          <button
            (click)="toggleUserMenu()"
            class="flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
          >
            <!-- User Avatar -->
            <div
              class="flex items-center justify-center w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full"
            >
              <span class="text-white text-sm font-semibold">
                {{ getUserInitials(currentUser?.fullName) }}
              </span>
            </div>

            <!-- User Info (Hidden on mobile) -->
            <div class="hidden lg:block text-left">
              <p class="text-sm font-semibold text-gray-900">
                {{ currentUser?.fullName }}
              </p>
              <p class="text-xs text-gray-500">{{ currentUser?.email }}</p>
            </div>

            <!-- Dropdown Arrow -->
            <ion-icon
              name="chevron-down-outline"
              class="text-gray-400 text-sm transition-transform duration-200"
              [class.rotate-180]="isUserMenuOpen"
            >
            </ion-icon>
          </button>

          <!-- Dropdown Menu -->
          <div
            *ngIf="isUserMenuOpen"
            class="absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-lg border border-gray-100 py-2 z-50"
            (click)="$event.stopPropagation()"
          >
            <!-- User Info Header (Mobile View) -->
            <div class="px-4 py-3 border-b border-gray-100 lg:hidden">
              <p class="text-sm font-semibold text-gray-900">
                {{ currentUser?.fullName }}
              </p>
              <p class="text-xs text-gray-500">{{ currentUser?.email }}</p>
            </div>

            <!-- User Details -->
            <div class="px-4 py-3 border-b border-gray-100">
              <div class="space-y-2">
                <!-- Role Information -->
                <div class="flex items-center justify-between">
                  <span class="text-sm text-gray-600">Role:</span>
                  <span
                    class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium"
                    [ngClass]="getRoleBadgeClass(currentUser?.role)"
                  >
                    <ion-icon
                      [name]="getRoleIcon(currentUser?.role)"
                      class="text-xs mr-1"
                    ></ion-icon>
                    {{ currentUser?.role }}
                  </span>
                </div>

                <!-- Bank Information (if applicable) -->
                <div
                  *ngIf="currentUser?.bankName"
                  class="flex items-center justify-between"
                >
                  <span class="text-sm text-gray-600">Bank:</span>
                  <span class="text-sm font-medium text-gray-900">{{
                    currentUser?.bankName
                  }}</span>
                </div>

                <!-- Client Information (if applicable) -->
                <div
                  *ngIf="currentUser?.clientName"
                  class="flex items-center justify-between"
                >
                  <span class="text-sm text-gray-600">Client:</span>
                  <span class="text-sm font-medium text-gray-900">{{
                    currentUser?.clientName
                  }}</span>
                </div>

                <!-- Username -->
                <div class="flex items-center justify-between">
                  <span class="text-sm text-gray-600">Username:</span>
                  <span class="text-sm font-medium text-gray-900">{{
                    currentUser?.userName
                  }}</span>
                </div>
              </div>
            </div>

            <!-- Menu Items -->
            <!-- <div class="py-2">

              <button
                class="w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors"
              >
                <ion-icon
                  name="person-outline"
                  class="text-gray-400 text-base mr-3"
                ></ion-icon>
                Profile Settings
              </button>


              <button
                class="w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors"
              >
                <ion-icon
                  name="shield-outline"
                  class="text-gray-400 text-base mr-3"
                ></ion-icon>
                Security
              </button>


              <button
                class="w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors"
              >
                <ion-icon
                  name="help-circle-outline"
                  class="text-gray-400 text-base mr-3"
                ></ion-icon>
                Help & Support
              </button>
            </div> -->

            <!-- Logout Section -->
            <div class="border-t border-gray-100 pt-2">
              <button
                (click)="logout()"
                [disabled]="isLoggingOut"
                class="w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors disabled:opacity-50"
              >
                <div
                  *ngIf="isLoggingOut"
                  class="animate-spin rounded-full h-4 w-4 border-b-2 border-red-600 mr-3"
                ></div>
                <ion-icon
                  *ngIf="!isLoggingOut"
                  name="log-out-outline"
                  class="text-red-500 text-base mr-3"
                ></ion-icon>
                {{ isLoggingOut ? "Logging out..." : "Logout" }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Role Badge (shown when desktop badge is hidden) -->
  <div class="md:hidden px-4 pb-2">
    <span
      class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium"
      [ngClass]="getRoleBadgeClass(currentUser?.role)"
    >
      <ion-icon
        [name]="getRoleIcon(currentUser?.role)"
        class="text-xs mr-1"
      ></ion-icon>
      {{ currentUser?.role }}
    </span>
  </div>
</nav>

<!-- Overlay for mobile menu -->
<div
  *ngIf="isUserMenuOpen"
  class="fixed inset-0 z-40 lg:hidden"
  (click)="closeUserMenu()"
></div>
